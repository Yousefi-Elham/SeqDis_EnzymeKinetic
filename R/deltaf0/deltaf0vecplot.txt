max.iter <- 500

norm.sum.crit.delta <- c( 0.03187914 ,0.04218482 ,0.07536279 ,0.08337209 ,0.09414993 ,0.10373216 ,0.12239780 ,0.12785434 ,0.13406617 ,0.14064237 ,0.15597805 ,0.15795378 ,0.16021405
                          ,0.17204739 ,0.17305660 ,0.17648915 ,0.18007843 ,0.18613525 ,0.18780251 ,0.19003863 ,0.18679907 ,0.18877920 ,0.19480639 ,0.19544973 ,0.19742013 ,0.20387042
                          ,0.20588724 ,0.20766469 ,0.20931678 ,0.21352171 ,0.21290723 ,0.21431513 ,0.21568667 ,0.21713469 ,0.21815451 ,0.21933062 ,0.22391043 ,0.22483647 ,0.22579372
                          ,0.22939738 ,0.23012312 ,0.22998615 ,0.23099893 ,0.23187607 ,0.23556771 ,0.23654024 ,0.23726975 ,0.23719492 ,0.23669554 ,0.23608810 ,0.23569213 ,0.23885949
                          ,0.23963333 ,0.23984169 ,0.24043946 ,0.23963980 ,0.24019258 ,0.24201492 ,0.24198986 ,0.24220799 ,0.24417199 ,0.24475292 ,0.24516639 ,0.24578693 ,0.24728819
                          ,0.24733684 ,0.24767603 ,0.24650556 ,0.24674387 ,0.24695080 ,0.24732568 ,0.24811092 ,0.24844923 ,0.24964190 ,0.24914400 ,0.24965101 ,0.25143982 ,0.25178360
                          ,0.25213355 ,0.25223451 ,0.25260046 ,0.25292892 ,0.25302551 ,0.25367934 ,0.25383056 ,0.25409846 ,0.25442540 ,0.25491715 ,0.25519303 ,0.25584246 ,0.25584288
                          ,0.25606548 ,0.25664519 ,0.25690091 ,0.25685382 ,0.25698384 ,0.25725578 ,0.25738747 ,0.25780273 ,0.25784021 ,0.25806490 ,0.25825810 ,0.25919559 ,0.25933890
                          ,0.25939981 ,0.25962012 ,0.25776406 ,0.25883540 ,0.25894592 ,0.25919428 ,0.25735578 ,0.25757711 ,0.25733425 ,0.25758510 ,0.25807405 ,0.25827211 ,0.25822876
                          ,0.25695340 ,0.25691538 ,0.25701352 ,0.25706848 ,0.25877158 ,0.25887367 ,0.25932977 ,0.25947174 ,0.25931070 ,0.25965603 ,0.25977269 ,0.25985636 ,0.25944834
                          ,0.25961748 ,0.25962529 ,0.26016794 ,0.25982284 ,0.25997164 ,0.26011931 ,0.26101514 ,0.26082146 ,0.26093507 ,0.26107100 ,0.26072779 ,0.26090131 ,0.26158334
                          ,0.26171782 ,0.26184987 ,0.26191799 ,0.26205649 ,0.26218092 ,0.26209488 ,0.26224486 ,0.26233546 ,0.26221293 ,0.26231422 ,0.26220457 ,0.26225112 ,0.26217626
                          ,0.26209404 ,0.26216687 ,0.26231111 ,0.26289430 ,0.26283953 ,0.26342387 ,0.26345480 ,0.26356362 ,0.26441242 ,0.26446278 ,0.26457774 ,0.26463553 ,0.26388241
                          ,0.26368959 ,0.26373937 ,0.26383747 ,0.26297380 ,0.26304890 ,0.26313438 ,0.26344820 ,0.26445565 ,0.26451468 ,0.26446808 ,0.26456548 ,0.26364174 ,0.26375668
                          ,0.26386066 ,0.26384497 ,0.26448405 ,0.26447707 ,0.26456642 ,0.26464407 ,0.26373362 ,0.26366323 ,0.26373011 ,0.26216956 ,0.26224372 ,0.26244134 ,0.26254150
                          ,0.26263150 ,0.26391253 ,0.26401990 ,0.26410945 ,0.26399381 ,0.26417549 ,0.26427158 ,0.26423383 ,0.26425398 ,0.26422636 ,0.26381783 ,0.26389272 ,0.26396400
                          ,0.26392427 ,0.26362955 ,0.26371118 ,0.26416628 ,0.26415502 ,0.26455340 ,0.26456679 ,0.26464008 ,0.26465506 ,0.26368514 ,0.26366461 ,0.26367346 ,0.26376437
                          ,0.26384645 ,0.26376389 ,0.26376679 ,0.26385545 ,0.26448760 ,0.26455415 ,0.26441183 ,0.26506179 ,0.26497471 ,0.26518178 ,0.26523345 ,0.26522904 ,0.26451913
                          ,0.26450603 ,0.26445271 ,0.26437912 ,0.26456420 ,0.26462538 ,0.26467811 ,0.26461500 ,0.26455999 ,0.26460935 ,0.26464345 ,0.26466508 ,0.26371474 ,0.26377285
                          ,0.26400784 ,0.26403473 ,0.26403189 ,0.26409800 ,0.26409768 ,0.26417053 ,0.26390512 ,0.26391865 ,0.26398691 ,0.26391919 ,0.26363373 ,0.26367779 ,0.26373471
                          ,0.26369635 ,0.26372325 ,0.26377275 ,0.26382144 ,0.26381520 ,0.26405939 ,0.26372980 ,0.26368746 ,0.26374924 ,0.26326141 ,0.26325434 ,0.26331389 ,0.26331853
                          ,0.26228042 ,0.26218382 ,0.26223402 ,0.26227335 ,0.26275567 ,0.26280419 ,0.26283190 ,0.26287414 ,0.26273459 ,0.26276472 ,0.26282542 ,0.26312403 ,0.26302680
                          ,0.26307921 ,0.26284396 ,0.26283864 ,0.26308017 ,0.26313006 ,0.26316128 ,0.26318609 ,0.26315852 ,0.26318144 ,0.26318953 ,0.26320265 ,0.26314473 ,0.26305101
                          ,0.26309529 ,0.26314304 ,0.26310365 ,0.26249345 ,0.26273391 ,0.26278578 ,0.26250482 ,0.26256095 ,0.26261158 ,0.26265707 ,0.26220641 ,0.26224240 ,0.26228035
                          ,0.26224857 ,0.26222197 ,0.26226436 ,0.26224137 ,0.26228764 ,0.26233190 ,0.26311137 ,0.26329573 ,0.26331498 ,0.26333823 ,0.26335420 ,0.26340170 ,0.26339161
                          ,0.26342426 ,0.26292762 ,0.26294062 ,0.26291606 ,0.26283060 ,0.26283386 ,0.26286881 ,0.26291165 ,0.26294721 ,0.26287492 ,0.26288020 ,0.26290241 ,0.26253538
                          ,0.26270538 ,0.26273865 ,0.26278309 ,0.26276849 ,0.26323707 ,0.26327932 ,0.26332348 ,0.26328225 ,0.26332892 ,0.26334547 ,0.26338679 ,0.26342928 ,0.26343744
                          ,0.26347182 ,0.26347403 ,0.26351291 ,0.26369625 ,0.26373490 ,0.26398931 ,0.26402838 ,0.26407132 ,0.26410089 ,0.26412157 ,0.26414403 ,0.26418178 ,0.26428801
                          ,0.26432312 ,0.26436587 ,0.26435575 ,0.26354282 ,0.26352251 ,0.26355597 ,0.26358133 ,0.26366255 ,0.26370084 ,0.26390609 ,0.26388162 ,0.26339166 ,0.26342574
                          ,0.26345386 ,0.26338722 ,0.26348342 ,0.26349403 ,0.26353045 ,0.26356482 ,0.26379363 ,0.26382119 ,0.26385076 ,0.26388986 ,0.26460758 ,0.26464668 ,0.26464863
                          ,0.26466892 ,0.26453055 ,0.26476014 ,0.26478466 ,0.26482273 ,0.26549499 ,0.26553478 ,0.26556541 ,0.26551640 ,0.26583258 ,0.26580795 ,0.26582594 ,0.26585026
                          ,0.26577053 ,0.26571400 ,0.26573684 ,0.26575030 ,0.26583230 ,0.26576837 ,0.26572511 ,0.26571751 ,0.26574009 ,0.26578448 ,0.26581301 ,0.26582069 ,0.26578908
                          ,0.26572002 ,0.26575389 ,0.26578776 ,0.26593187 ,0.26593249 ,0.26595103 ,0.26596638 ,0.26635701 ,0.26638559 ,0.26640850 ,0.26652240 ,0.26655746 ,0.26656974
                          ,0.26617094 ,0.26619293 ,0.26637325 ,0.26639853 ,0.26642655 ,0.26645097 ,0.26647807 ,0.26620118 ,0.26623160 ,0.26624603 ,0.26627771 ,0.26609875 ,0.26612134
                          ,0.26615388 ,0.26617903 ,0.26608338 ,0.26625844 ,0.26629127 ,0.26628175 ,0.26612227 ,0.26613251 ,0.26616027 ,0.26615357 ,0.26613108 ,0.26613602 ,0.26614014
                          ,0.26612513 ,0.26624247 ,0.26626109 ,0.26628664 ,0.26628137 ,0.26631074 ,0.26633512 ,0.26633618 ,0.26643096 ,0.26662930 ,0.26663307 ,0.26665251 ,0.26668271
                          ,0.26679579 ,0.26682762 ,0.26684516 ,0.26684630 ,0.26688480 ,0.26691159 ,0.26693670 ,0.26696004 ,0.26711498 ,0.26711360 ,0.26712909 ,0.26714892 ,0.26736371
                          ,0.26738776 ,0.26751868 ,0.26753931 ,0.26751813 ,0.26750272 ,0.26708390 ,0.26703302 ,0.26703516 ,0.26706087 ,0.26705147 ,0.26707728 ,0.26708604 ,0.26722541
                          ,0.26725241 ,0.26726210 ,0.26728184 ,0.26749936 ,0.26750638 ,0.26766149)


plot(seq(1:max.iter),norm.sum.crit.delta  , type = "p",ylim=c(0,0.3),xlab="iter",ylab= bquote ( paste("Norm.Criterion ", delta)) ,pch=16,col="blue",,cex.main=2, cex.lab=1.5, cex.axis=1.5)
abline(h=max(norm.sum.crit.delta ),lty=2,col="red")

max(norm.sum.crit.delta)

quantile(norm.sum.crit.delta )
per0.5 <- quantile(norm.sum.crit.delta )[3]-quantile(norm.sum.crit.delta )[1]
per0.5 / (max(norm.sum.crit.delta )-min(norm.sum.crit.delta ))

#compute
which(norm.sum.crit.delta >= max(norm.sum.crit.delta)/2)[1]

which(norm.sum.crit.delta  >= 3*norm.sum.crit.delta [1])[1]
length(which(norm.sum.crit.delta  >= 3*norm.sum.crit.delta [1]))
#boxplot(norm.sum.crit.delta )

quanDelta <-  c(0.25,0.5,0.75,0.9,0.95)
quanDelta

#25%       50%       75%       90%       95% 
#0.2594659 0.2634128 0.2646108 0.2663132 0.2669379 

#round 25%   50%   75%   90%   95% 
#     0.2595 0.2634 0.2646 0.2663 0.2669



earlyiterdelta <- numeric(length(quanDelta))
for(i in 1:length(quanDelta)){
  earlyiterdelta[i] <- which(norm.sum.crit.delta >= max(norm.sum.crit.delta)*quanDelta[i])[1]
}
earlyiterdelta
#[1]  3  9 26 58 87

#$\delta$&$0.2595$&$ 0.2634$&$ 0.2646$&$ 0.2663$&$ 0.2669$&&$ 106$&$ 162$&$ 168$&$ 424$&$ 476$\\
######################################################################
######################################################################
