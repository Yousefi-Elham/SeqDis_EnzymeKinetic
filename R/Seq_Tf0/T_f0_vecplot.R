max.iter <- 500

norm.sum.crit.t <- c( 0.07003184 ,0.12316297 ,0.11592051 ,0.12807945 ,0.13388391 ,0.14312683 ,0.15932448 ,0.16425062 ,0.16770764 ,0.18624000 ,0.19266443 ,0.19553780 ,0.19976929
                      ,0.20850674 ,0.21109611 ,0.21176245 ,0.21622710 ,0.21905302 ,0.21584366 ,0.21919020 ,0.21453870 ,0.21789574 ,0.21906087 ,0.22173961 ,0.21875475 ,0.22162810
                      ,0.22283510 ,0.22502056 ,0.22629226 ,0.22726824 ,0.22186378 ,0.22336296 ,0.22455375 ,0.22481004 ,0.22593146 ,0.22955640 ,0.23106395 ,0.23208656 ,0.23311524
                      ,0.23254601 ,0.23345480 ,0.23430080 ,0.23512817 ,0.23679359 ,0.23771005 ,0.23838457 ,0.23899317 ,0.23598100 ,0.23643761 ,0.24057302 ,0.24157106 ,0.24260871
                      ,0.24257891 ,0.24332287 ,0.24373451 ,0.24435431 ,0.24365912 ,0.24433506 ,0.24450659 ,0.24908782 ,0.24965979 ,0.25007687 ,0.25047738 ,0.25189572 ,0.25237064
                      ,0.25248300 ,0.25285088 ,0.25220541 ,0.25236944 ,0.25278250 ,0.25316162 ,0.25366198 ,0.25608263 ,0.25655746 ,0.25652191 ,0.25686445 ,0.25727804 ,0.25769352
                      ,0.25802178 ,0.25847414 ,0.25876562 ,0.25899721 ,0.25907876 ,0.26004016 ,0.26024313 ,0.25974906 ,0.25994878 ,0.26014551 ,0.26136774 ,0.26169453 ,0.26206481
                      ,0.26232460 ,0.26316610 ,0.26337355 ,0.26335174 ,0.26370541 ,0.26397219 ,0.26404783 ,0.26414468 ,0.26528168 ,0.26546426 ,0.26547073 ,0.26573531 ,0.26587806
                      ,0.26813712 ,0.26826904 ,0.26832746 ,0.26857900 ,0.26904553 ,0.26921487 ,0.26948220 ,0.26967821 ,0.27147515 ,0.27168012 ,0.27170156 ,0.27188508 ,0.27295917
                      ,0.27312967 ,0.27316315 ,0.27333577 ,0.27398790 ,0.27427163 ,0.27436484 ,0.27436259 ,0.27388363 ,0.27412036 ,0.27425995 ,0.27439007 ,0.27357159 ,0.27360908
                      ,0.27364174 ,0.27260493 ,0.27260514 ,0.27288926 ,0.27262103 ,0.27294380 ,0.27294262 ,0.27316278 ,0.27323734 ,0.27409954 ,0.27421425 ,0.27425719 ,0.27432687
                      ,0.27481060 ,0.27476935 ,0.27483876 ,0.27490053 ,0.27510011 ,0.27516328 ,0.27518688 ,0.27486636 ,0.27347588 ,0.27357751 ,0.27351387 ,0.27358526 ,0.27236361
                      ,0.27242813 ,0.27247738 ,0.27290249 ,0.27294719 ,0.27293131 ,0.27351218 ,0.27352371 ,0.27362116 ,0.27374916 ,0.27422702 ,0.27426988 ,0.27433106 ,0.27434733
                      ,0.27581038 ,0.27592529 ,0.27606456 ,0.27606080 ,0.27611795 ,0.27597046 ,0.27609037 ,0.27622047 ,0.27615779 ,0.27701950 ,0.27712946 ,0.27712359 ,0.27746010
                      ,0.27757446 ,0.27772092 ,0.27782412 ,0.27793315 ,0.27794327 ,0.27783387 ,0.27782531 ,0.27871906 ,0.27878760 ,0.27873647 ,0.27879089 ,0.27968221 ,0.27980411
                      ,0.27986484 ,0.28000852 ,0.27933363 ,0.27935925 ,0.27957614 ,0.27963628 ,0.27965524 ,0.27875364 ,0.27884526 ,0.27894025 ,0.27896604 ,0.27918091 ,0.27921637
                      ,0.27931295 ,0.27892236 ,0.27902899 ,0.27912735 ,0.27920476 ,0.27926800 ,0.27934945 ,0.28005436 ,0.27990728 ,0.27987064 ,0.27996071 ,0.27997717 ,0.27994949
                      ,0.27995266 ,0.28006017 ,0.28006807 ,0.27947310 ,0.27956569 ,0.27957346 ,0.28067959 ,0.28076753 ,0.28097814 ,0.28092771 ,0.28072910 ,0.28058441 ,0.28055774
                      ,0.28055185 ,0.28064456 ,0.28152709 ,0.28157422 ,0.28157098 ,0.28160685 ,0.28063155 ,0.28064924 ,0.28066344 ,0.28061155 ,0.28017966 ,0.28011865 ,0.28090855
                      ,0.28089079 ,0.28095003 ,0.28093290 ,0.28099792 ,0.28142261 ,0.28141512 ,0.28141339 ,0.28099526 ,0.28099000 ,0.28108369 ,0.28107959 ,0.28198483 ,0.28207192
                      ,0.28203603 ,0.28205716 ,0.28104637 ,0.28100063 ,0.28098498 ,0.28120372 ,0.28127322 ,0.28136495 ,0.28135737 ,0.28135388 ,0.28076203 ,0.28073846 ,0.28079390
                      ,0.27968142 ,0.27962375 ,0.27963413 ,0.27951450 ,0.27950253 ,0.27951929 ,0.27932270 ,0.27935324 ,0.27939172 ,0.27943023 ,0.27934055 ,0.27906409 ,0.27908255
                      ,0.27911439 ,0.27902960 ,0.27856627 ,0.27861071 ,0.27864692 ,0.27849879 ,0.27850969 ,0.27858183 ,0.27860915 ,0.27828208 ,0.27828084 ,0.27836423 ,0.27839901
                      ,0.27860674 ,0.27854538 ,0.27862135 ,0.27869930 ,0.27872832 ,0.27914631 ,0.27913886 ,0.27918599 ,0.27924927 ,0.27939557 ,0.27937237 ,0.27938649 ,0.27947297
                      ,0.27888080 ,0.27888993 ,0.27891498 ,0.27889970 ,0.27944402 ,0.27945220 ,0.27954662 ,0.27954032 ,0.27931904 ,0.27934825 ,0.27936450 ,0.27934779 ,0.27889408
                      ,0.27890975 ,0.27888287 ,0.27866366 ,0.27863617 ,0.27858869 ,0.27849208 ,0.27851918 ,0.27855673 ,0.27854700 ,0.27838715 ,0.27838444 ,0.27839691 ,0.27838621
                      ,0.27859055 ,0.27861225 ,0.27861390 ,0.27899453 ,0.27905123 ,0.27908702 ,0.27914135 ,0.27911600 ,0.27906592 ,0.27906732 ,0.27911564 ,0.27935362 ,0.27937253
                      ,0.27938463 ,0.27938452 ,0.27938689 ,0.27948429 ,0.27948018 ,0.27946034 ,0.27993967 ,0.27991336 ,0.27992972 ,0.27903678 ,0.27905371 ,0.27911247 ,0.27913456
                      ,0.27973172 ,0.27970693 ,0.27975281 ,0.27993592 ,0.27949794 ,0.27952556 ,0.27954461 ,0.27956822 ,0.28001933 ,0.28002237 ,0.28000605 ,0.27941978 ,0.27944615
                      ,0.27946413 ,0.27943126 ,0.27942368 ,0.27942703 ,0.27992305 ,0.27992984 ,0.27993677 ,0.27990585 ,0.27991593 ,0.28011309 ,0.28019514 ,0.28017922 ,0.28021051
                      ,0.28011112 ,0.28011521 ,0.28018438 ,0.28019985 ,0.28054725 ,0.28050609 ,0.28054502 ,0.28033308 ,0.28030423 ,0.28022707 ,0.28021179 ,0.28011267 ,0.28013483
                      ,0.28013997 ,0.28067323 ,0.28069084 ,0.28069970 ,0.28071814 ,0.28127964 ,0.28123311 ,0.28122775 ,0.28115015 ,0.28116872 ,0.28119642 ,0.28120230 ,0.28107060
                      ,0.28091464 ,0.28097491 ,0.28097014 ,0.28099699 ,0.28115884 ,0.28117711 ,0.28119878 ,0.28124566 ,0.28103673 ,0.28106013 ,0.28106208 ,0.28137801 ,0.28140267
                      ,0.28145538 ,0.28147128 ,0.28149753 ,0.28139004 ,0.28135683 ,0.28133417 ,0.28134429 ,0.28098050 ,0.28101446 ,0.28103432 ,0.28103445 ,0.28076783 ,0.28078816
                      ,0.28077599 ,0.28014563 ,0.28014710 ,0.28014131 ,0.28036267 ,0.28035693 ,0.28035445 ,0.28022078 ,0.28019024 ,0.28022505 ,0.28024757 ,0.28025420 ,0.28035292
                      ,0.28034356 ,0.28035308 ,0.28033568 ,0.28033425 ,0.28033026 ,0.28034895 ,0.28090247 ,0.28092738 ,0.28092957 ,0.28095784 ,0.28075997 ,0.28077088 ,0.28070061
                      ,0.28071147 ,0.28098367 ,0.28099547 ,0.28099551 ,0.28101342 ,0.28109413 ,0.28108887 ,0.28111152 ,0.28119071 ,0.28119281 ,0.28120502 ,0.28122400 ,0.28136679
                      ,0.28139209 ,0.28139660 ,0.28137894 ,0.28100309 ,0.28104357 ,0.28109662 ,0.28106936 ,0.28099138 ,0.28102365 ,0.28110987 ,0.28115714 ,0.28116345 ,0.28118568
                      ,0.28149487 ,0.28149965 ,0.28151901 ,0.28167223 ,0.28167396 ,0.28165462)


plot(seq(1:max.iter),norm.sum.crit.t  , type = "p",ylim=c(0,0.3),xlab="iter",ylab="Norm.Criterion T",pch=16,col="blue",cex.main=2, cex.lab=1.5, cex.axis=1.5)
abline(h=max(norm.sum.crit.t ),lty=2,col="red")

max(norm.sum.crit.t)

quantile(norm.sum.crit.t)
per0.5 <- quantile(norm.sum.crit.t )[3]-quantile(norm.sum.crit.t )[1]
per0.5 / (max(norm.sum.crit.t )-min(norm.sum.crit.t ))

#compute
which(norm.sum.crit.t >= max(norm.sum.crit.t)/2)[1]

which(norm.sum.crit.t  >= 3*norm.sum.crit.t [1])[1]
length(which(norm.sum.crit.t  >= 3*norm.sum.crit.t[1]))
boxplot(norm.sum.crit.t )

quanT <-  c(0.25,0.5,0.75,0.9,0.95)
quanT

#25%       50%       75%       90%       95% 
#0.2729398 0.2791217 0.2803985 0.2811593 0.2813781 

#round 25%    50%    75%    90%    95% 
#    0.2729 0.2791 0.2804 0.2812 0.2814 

earlyitert <- numeric(length(quanT))
for(i in 1:length(quanT)){
  earlyitert[i] <- which(norm.sum.crit.t >= max(norm.sum.crit.t)*quanT[i])[1]
}
earlyitert
#[1]   2   6  16  73 105

#$T$&$0.2729$&$ 0.2791$&$ 0.2804$&$ 0.2812$&$ 0.2814$&&$ 117$&$ 194$&$ 228$&$ 237$&$ 237$\\
###############################################
###############################################
#full quantiles
#quanT
#2%        5%       10%       25%       50%       75%       90%       95%      100% 
#0.1925359 0.2217340 0.2414713 0.2729398 0.2791217 0.2803985 0.2811593 0.2813781 0.2820719 

#earlyitert
#[1]  11  24  51 117 194 228 237 237 260