#f1
max.iter <- 500

norm.sum.crit.t <- c( 
  0.05907629 ,0.11228456 ,0.13654939 ,0.12617543 ,0.14094719 ,0.14861416 ,0.16482486 ,0.17361645 ,0.17542438 ,0.19259023 ,0.18548519 ,0.18506646 ,0.18665324
  ,0.19798983 ,0.20546944 ,0.21003764 ,0.21174389 ,0.21765845 ,0.21563001 ,0.21850131 ,0.22333507 ,0.22516407 ,0.22931643 ,0.23470583 ,0.23394339 ,0.24079898
  ,0.23776921 ,0.24042242 ,0.24106814 ,0.24561923 ,0.22596375 ,0.22809847 ,0.22793015 ,0.22824791 ,0.23075773 ,0.23046704 ,0.22705798 ,0.22797858 ,0.22896893
  ,0.23069609 ,0.23202671 ,0.23272834 ,0.23206142 ,0.23355715 ,0.23025188 ,0.22955379 ,0.23193425 ,0.23543318 ,0.23579210 ,0.23612645 ,0.23316549 ,0.23008405
  ,0.22879957 ,0.23037384 ,0.23103293 ,0.23177067 ,0.23129183 ,0.23024648 ,0.23238831 ,0.23620679 ,0.23454798 ,0.23440963 ,0.23525449 ,0.23650966 ,0.23651397
  ,0.23820457 ,0.23952867 ,0.23913576 ,0.23861743 ,0.23995205 ,0.24096893 ,0.24212489 ,0.24429696 ,0.24321614 ,0.24602681 ,0.24611051 ,0.24796692 ,0.24971454
  ,0.25098745 ,0.25134578 ,0.25120034 ,0.25130222 ,0.25046516 ,0.25127758 ,0.25238373 ,0.25390902 ,0.25330120 ,0.25277280 ,0.25476587 ,0.25646751 ,0.25827148
  ,0.25873979 ,0.25945531 ,0.25932426 ,0.26064603 ,0.26050591 ,0.26167533 ,0.26081164 ,0.26133844 ,0.26042990 ,0.26049130 ,0.26096706 ,0.26194002 ,0.26223895
  ,0.26030954 ,0.25948959 ,0.25830367 ,0.25778634 ,0.25742867 ,0.25792902 ,0.25945262 ,0.25979571 ,0.26038868 ,0.26120293 ,0.26171993 ,0.26153133 ,0.26254672
  ,0.26373240 ,0.26261758 ,0.26220924 ,0.26154842 ,0.26320011 ,0.26374417 ,0.26480531 ,0.26454280 ,0.26815260 ,0.26784948 ,0.26763146 ,0.26691930 ,0.26653880
  ,0.26735656 ,0.26654457 ,0.26708248 ,0.26511032 ,0.26652134 ,0.26681694 ,0.26600022 ,0.26737044 ,0.26735090 ,0.26661416 ,0.26636022 ,0.26686183 ,0.26678997
  ,0.26679112 ,0.26773089 ,0.26774241 ,0.26738911 ,0.26762985 ,0.26774101 ,0.26705875 ,0.26960754 ,0.26834105 ,0.26827573 ,0.26932573 ,0.26982338 ,0.26884841
  ,0.26880669 ,0.26860881 ,0.26896777 ,0.26744953 ,0.26655455 ,0.26606290 ,0.26656232 ,0.26660218 ,0.26741089 ,0.26701859 ,0.26728182 ,0.26702628 ,0.26768409
  ,0.26896156 ,0.26933732 ,0.27010067 ,0.27085571 ,0.27099504 ,0.27092538 ,0.27029073 ,0.27122008 ,0.27177435 ,0.27256624 ,0.27184403 ,0.27108366 ,0.27144391
  ,0.27204024 ,0.27136042 ,0.27246801 ,0.27308371 ,0.27245498 ,0.27242575 ,0.27324254 ,0.27406118 ,0.27401819 ,0.27534613 ,0.27520777 ,0.27430404 ,0.27362876
  ,0.27347065 ,0.27469315 ,0.27524189 ,0.27542573 ,0.27422742 ,0.27408398 ,0.27356678 ,0.27087529 ,0.27047617 ,0.26983441 ,0.26948024 ,0.26973161 ,0.26969694
  ,0.27038046 ,0.27068201 ,0.27126042 ,0.27064236 ,0.27005235 ,0.27004344 ,0.26962522 ,0.27027636 ,0.26983514 ,0.26901720 ,0.26695615 ,0.26656513 ,0.26656567
  ,0.26620687 ,0.26543043 ,0.26592937 ,0.26550042 ,0.26493992 ,0.26509785 ,0.26609392 ,0.26550192 ,0.26718749 ,0.26735381 ,0.26724083 ,0.26677118 ,0.26614700
  ,0.26671779 ,0.26600506 ,0.26807689 ,0.26822106 ,0.26802187 ,0.26806943 ,0.26731513 ,0.26741184 ,0.26742388 ,0.26850419 ,0.26819754 ,0.26740392 ,0.26920301
  ,0.26880557 ,0.26905449 ,0.26881117 ,0.26919931 ,0.26879108 ,0.26910088 ,0.26884927 ,0.26917641 ,0.26876735 ,0.26956128 ,0.26928420 ,0.27013080 ,0.27079961
  ,0.27020345 ,0.26975225 ,0.26898511 ,0.26828074 ,0.26788491 ,0.26763669 ,0.26732490 ,0.26750860 ,0.26783511 ,0.26739517 ,0.26786896 ,0.26738807 ,0.26708793
  ,0.26803893 ,0.26721473 ,0.26739736 ,0.26737203 ,0.26819106 ,0.26812720 ,0.26824589 ,0.26828871 ,0.26814035 ,0.26805829 ,0.26834596 ,0.26854021 ,0.26841563
  ,0.26835151 ,0.26731817 ,0.26592388 ,0.26575567 ,0.26567070 ,0.26576340 ,0.26564805 ,0.26613443 ,0.26616036 ,0.26593339 ,0.26573527 ,0.26509155 ,0.26498119
  ,0.26476007 ,0.26498013 ,0.26519608 ,0.26464918 ,0.26449232 ,0.26490205 ,0.26521918 ,0.26494495 ,0.26453314 ,0.26471237 ,0.26429264 ,0.26429955 ,0.26495350
  ,0.26544395 ,0.26537161 ,0.26524552 ,0.26564868 ,0.26615571 ,0.26622910 ,0.26694285 ,0.26693505 ,0.26678568 ,0.26691374 ,0.26695263 ,0.26730453 ,0.26768023
  ,0.26769449 ,0.26723079 ,0.26645675 ,0.26603610 ,0.26533507 ,0.26530162 ,0.26522721 ,0.26501324 ,0.26501031 ,0.26490863 ,0.26469967 ,0.26459704 ,0.26424563
  ,0.26403230 ,0.26393515 ,0.26411037 ,0.26448685 ,0.26409468 ,0.26431022 ,0.26473629 ,0.26425748 ,0.26426830 ,0.26441868 ,0.26406848 ,0.26382292 ,0.26379504
  ,0.26373161 ,0.26394834 ,0.26413799 ,0.26408520 ,0.26325520 ,0.26286543 ,0.26241094 ,0.26285910 ,0.26285276 ,0.26361559 ,0.26358401 ,0.26406279 ,0.26412740
  ,0.26469751 ,0.26426374 ,0.26454040 ,0.26528021 ,0.26494800 ,0.26505119 ,0.26506529 ,0.26510252 ,0.26527860 ,0.26512568 ,0.26475112 ,0.26428663 ,0.26440988
  ,0.26437103 ,0.26496290 ,0.26486039 ,0.26474616 ,0.26425485 ,0.26412896 ,0.26397017 ,0.26405257 ,0.26395097 ,0.26372949 ,0.26439097 ,0.26450081 ,0.26466802
  ,0.26471986 ,0.26455939 ,0.26400783 ,0.26379444 ,0.26344700 ,0.26406380 ,0.26432779 ,0.26448171 ,0.26401817 ,0.26376142 ,0.26412708 ,0.26408918 ,0.26404348
  ,0.26394456 ,0.26342657 ,0.26346647 ,0.26328718 ,0.26324911 ,0.26379272 ,0.26309360 ,0.26285938 ,0.26285369 ,0.26286479 ,0.26276769 ,0.26290529 ,0.26284894
  ,0.26342955 ,0.26299290 ,0.26323490 ,0.26314970 ,0.26356746 ,0.26356647 ,0.26342059 ,0.26375655 ,0.26391239 ,0.26398335 ,0.26413356 ,0.26381759 ,0.26393828
  ,0.26433782 ,0.26438249 ,0.26451511 ,0.26457667 ,0.26510132 ,0.26502913 ,0.26493162 ,0.26465840 ,0.26470974 ,0.26467342 ,0.26491808 ,0.26473135 ,0.26483334
  ,0.26515057 ,0.26569090 ,0.26557408 ,0.26584764 ,0.26608097 ,0.26631112 ,0.26650161 ,0.26642271 ,0.26630803 ,0.26651728 ,0.26646023 ,0.26658129 ,0.26670411
  ,0.26699243 ,0.26706564 ,0.26697824 ,0.26681527 ,0.26703182 ,0.26702379 ,0.26755891 ,0.26741428 ,0.26756055 ,0.26741270 ,0.26685131 ,0.26682256 ,0.26708768
  ,0.26702281 ,0.26729723 ,0.26733085 ,0.26718597 ,0.26718753 ,0.26717317 ,0.26696875 ,0.26685541 ,0.26696446 ,0.26680994 ,0.26681529 ,0.26688099 ,0.26671273
  ,0.26660264 ,0.26625426 ,0.26632704 ,0.26663464 ,0.26689896 ,0.26730554 ,0.26686585 ,0.26683324 ,0.26700147 ,0.26781924 ,0.26803010 ,0.26809322 ,0.26800076
  ,0.26831010 ,0.26825447 ,0.26833921 ,0.26850865 ,0.26860651 ,0.26828093)


plot(seq(1:max.iter),norm.sum.crit.t  , type = "p",ylim=c(0,0.3),xlab="iter",ylab="Norm.Criterion T",pch=16,col="blue")
abline(h=max(norm.sum.crit.t ),lty=2,col="red")

max(norm.sum.crit.t)

quantile(norm.sum.crit.t)
per0.5 <- quantile(norm.sum.crit.t )[3]-quantile(norm.sum.crit.t )[1]
per0.5 / (max(norm.sum.crit.t )-min(norm.sum.crit.t ))

#compute
which(norm.sum.crit.t >= max(norm.sum.crit.t)/2)[1]

which(norm.sum.crit.t  >= 3*norm.sum.crit.t [1])[1]
length(which(norm.sum.crit.t  >= 3*norm.sum.crit.t[1]))
boxplot(norm.sum.crit.t )

quanT <-  c(0.25,0.5,0.75,0.9,0.95)
quanT
#25%       50%       75%       90%       95% 
#0.2628577 0.2651733 0.2674111 0.2696093 0.2712221 

#round 25%    50%    75%    90%    95% 
#    0.2629 0.2652 0.2674 0.2696 0.2712 

earlyitert <- numeric(length(quanT))
for(i in 1:length(quanT)){
  earlyitert[i] <- which(norm.sum.crit.t >= max(norm.sum.crit.t)*quanT[i])[1]
}
earlyitert
#[1]  2  5 16 77 97

earlyitert11 <- numeric(length(quanT)) 
for(i in 1:length(quanT)){
  earlyitert11[i] <- which(norm.sum.crit.t >= 0.2677787*quanT[i])[1]
}
earlyitert11
[1]  2  3 15 29 89

#---------------------
Quan <- round(quantile(norm.sum.crit.t, probs= c(0.25,0.5,0.75,0.9,0.95)),digits=4)
Quan
25%    50%    75%    90%    95% 
0.2629 0.2652 0.2674 0.2696 0.2712 